<!doctype html><html lang=ja><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"><meta charset=utf-8><meta content="Meiryo7743" name=author><meta name=description content="ありがた迷惑なスクリーンセーバー 最近，とある Windows PC を利用する機会があります。その PC では，3 分ほど無操作状態が続くとスクリーンセーバーが起動し，"><meta content="telephone=no,address=no,email=no" name=format-detection><meta content="width=device-width,initial-scale=1" name=viewport><meta content="light dark" name=color-scheme><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><title>スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！ - Meiryo7743</title><meta content="ありがた迷惑なスクリーンセーバー 最近，とある Windows PC を利用する機会があります。その PC では，3 分ほど無操作状態が続くとスクリーンセーバーが起動し，" property="og:description"><meta content="https://meiryo7743.net/img/ogp.ca2d905751f19a6a5e739afe47434c093a7fecf653628d18a494380a7794d2b4.png" property="og:image"><meta content="Meiryo7743" property="og:site_name"><meta content="スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！ - Meiryo7743" property="og:title"><meta content="article" property="og:type"><meta content="https://meiryo7743.net/ja/blog/how-to-disable-screensaver-with-a-powershell-script/" property="og:url"><link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAAAAAAYplnuAAAAAXNSR0IArs4c6QAAAlVJREFUeNrt3KFtREEMRdGp5fcQsH2lARe3ZbiXKMhoniw5V/FK74IhQw4wMPJ5PrDzfGBGP4/RRouMNlpktNEio40WGW20yGijRUYbLTLaaJHRRouMNlpktNEio40WLUPH9SMnvb9IdC5S99GL1H30InUfvUjdRy9S99GL1H30InUfvUjdRy9S99GL1H30InUf3VF/R6erGkBLdb/X+2Z+segMxAyjMwAzjs4AzDg6AzDj6AzAjKMzADOOzgDMODoDMOPoDMCMozMAM47OGJtBdAg1YdZoQE2ZCw2oKXOhATVlLjSgpsyFBtSUudCAmjIXGlBT5kIDas5caEDNmQsNqDlzoQF128yjtXpgRtFaPTCjaK0emFG0Vg/MKFqrB2YUrdUDM4rW6ps5hZlFa7UuHtUcvVl9RW9WX9Gb1Vf0ZvUVvVl9RW9WX9Gb1Vf0ZvUVvVl9RW9WX9Gb1X+EfuWldwzUJFrvzwM1iNbmZ6AG0do8UINobR6oQbQ2D9QgWpsHahCtzZC60ICZUReaMCPqQiNmQl1oxkyqD2RG1Ycxs+qDmGH1Icy0+gBmXH0AM64+gBlXH97cVw/QlLkKAE2ZqwDQlLkKAE2ZqwDQlLkKAE2ZqwDQlLkKAE2ZqwDQlLkKAE2ZqwDQlLkKFn0zZ3T6FmoQ/fXOSUKNzjSv7qMXqfvoReo+epG6j16k7qMXqfvoReo+epG6j16k7qMXqfvoRerfx4d2NmX08xhttMhoo0VGGy0y2miR0UaLjDZaZLTRIqONFhlttMhoo0VGGy0y2uh/7wfR3/m4emvbngAAAABJRU5ErkJggg==" rel=apple-touch-icon sizes=180x180><link href="data:image/svg+xml;utf8,%3Csvg%20viewBox=%220%200%2016%2016%22%20xmlns=%22http://www.w3.org/2000/svg%22%20fill=%22%23222%22%3E%3Ctitle%20property=%22dc:title%22%3EMeiryo7743%3C/title%3E%3Cdesc%20property=%22dc:creator%22%3EMeiryo7743%3C/desc%3E%3Cstyle%3E@media(prefers-color-scheme:dark)%7B*%7Bfill:%23ddd%7D%7D%3C/style%3E%3Cpath%20d=%22M0%200v4l5%205-5%205%202%202h10l-2-2H4l5-5%207%207v-4l-5-5%205-5-2-2H4l2%202h6L7%207z%22/%3E%3C/svg%3E" rel=icon type=image/svg+xml><link href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAAAAAB5Gfe6AAAAAXNSR0IArs4c6QAAA95JREFUeNrt3Mtt60AUA1DXwkYzjaaXt36LOBZzL0AOyQIM8gD5WBrphfC8EJ4CIDwFQHgKgPAUAOEpAMJTAISnAAhPARCeAiA8BUB4CoDwFADhKQDCUwCEpwAITwEQngIgPAVAeAqA8BQA4SkAwlMAhKcACE8BEJ4CIDwFQHgKgPDQAAe/53xv5YDILMD3JQI8wCUCPMAlAjzAJQI8wCUCPMAlAjzAJQI8wCUCPMAlAjzAJQI8wCUCPMAlAjzAJQI8wCUCPMAlAjzAJQI8wCUCNADRgc0xAfishNh+HoCtIbafB2CLiO3nAdgqYvt5ALaM2H4egK0jtp8HYAuJ7ecB2Epi+3kAtpTYfh6ArSW2nwdgi4nt5wHYamL7eQC2nNh+HoCtJ7afB2ALiu3nAdiKYvt5ALak2P4HAExNqQ8GD8AXlflYCmCiqsSH8gALZcX2swB8XbH9LABfWGw/C8BXFtvPAvClxfazAHxtsf0sAF9cbD8LwFcX288C8OXF9rMAfH2x/SwAP0BsPwvATxDbzwLwI8T20wD0DLH94AHIIWL7/wRATRHb/0cAYozY/gGAp3O09g8APB4ktX8E4KmA0v4hgIcCQvvHAJ4J6OwfBHgkILN/AQBfH0z7Utm/AYAj8SzMmywC+AkMA/gJDAP4CQwD+AkMA/gJDAP4CQwD+AkMA/gJDAP4CQwD+AkMA/gJDAP4CQwD+AkMA/gJDAP4CQwD+AkMA/gJbAPIXyRT+RE4tsfk3sbgQrnGn8ED16Oyb2Nxs2wRwON26R6AyQ3zNQCXIxNbADaHZpYAfI5N7QAYHZxbAXA6OrkBYHV4dgHA6/j0PIDZAfpxALdHKKYB7B6iGQbwe4xqFsDwQbpRAMdHKScBLB+mHQTwfJx6DsD0gfoxANdXKkwB2L5U4x2ASFXR1+r+F+MX6/wEIFXzk4/G84g8OPlJjj7A6n7gqAMs7weONsD6fuAoA+zvB3B0AYj9TI4qALGfy9EEIPazOYoAxH4+Rw+A2s/nqAGQ+/kcLQB6P5+jBMDvB5+jA0Dsn8hRASD2z+RoABD7p3JmAERfrPxJjgnA3pnwY/IjsChg8ktwUcDkz+CigMk/QosCJv8KLwqYfBlaFDD5OrwoYHJBZFHA5JLYooDJRdFFAZPL4osCJjdGFgVMbo0tCpjcHF0UMLk9vihgckBiUWAcwE4AZF4ITwEQngIgPAVAeAqA8BQA4SkAwlMAhKcACE8BEJ4CIDwFQHgKgPAUAOEpAMJTAISnAAhPARCeAiA8BUB4CoDwFADhKQDCUwCEpwAITwEQngIgPAVAeOIB/gGtcnOOTBwCcQAAAABJRU5ErkJggg==" rel="icon alternate" sizes=256x256 type=image/png><link href=https://meiryo7743.net/scss/style.min.4476ece75ae4d1322f757e456947f53739629d6cb1905acd889dcdd97cb292a9.css rel=stylesheet><link data-href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Noto+Serif+JP&family=Source+Serif+Pro:ital@0;1&display=swap" data-loading=lazy rel=stylesheet><link data-href=https://cdn.jsdelivr.net/gh/daiji256/yaku-kumi-fonts@v1.2/css/yakukumi-serif-r.min.css data-loading=lazy rel=stylesheet><noscript><link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Noto+Serif+JP&family=Source+Serif+Pro:ital@0;1&display=swap" rel=stylesheet></noscript><noscript><link href=https://cdn.jsdelivr.net/gh/daiji256/yaku-kumi-fonts@v1.2/css/yakukumi-serif-r.min.css rel=stylesheet></noscript></head><body class=body><header class=body__header><nav class=menu><ul class=menu__container><li class=menu__item><a href=https://meiryo7743.net/ja/ class=menu__link>Meiryo7743</a><li class=menu__item><a href=https://meiryo7743.net/ja/blog/ class=menu__link>Blog</a><li class=menu__item><a href=https://meiryo7743.net/ja/about/ class=menu__link>About</a><li class=menu__item><a class=menu__link href=https://forms.gle/6HEnaSwjchbk5P237 rel=noopener target=_blank>Contact</a></ul></nav></header><main class=body__main><article class=single><header class="card card--single"><ul class=time><li class=time__item><time aria-label=公開：2022-12-05 datetime=2022-12-05T08:00:00+0900>2022-12-05</time><li class="time__item time__item--update"><time aria-label=更新：2022-12-05 datetime=2022-12-05T07:48:36+0900>2022-12-05</time></ul><nav class=tags><ul class=tags__container><li class=tags__item><a href=https://meiryo7743.net/ja/tags/powershell/>PowerShell</a><li class=tags__item><a href=https://meiryo7743.net/ja/tags/%E5%82%99%E5%BF%98%E9%8C%B2/>備忘録</a></ul></nav><h1 class=card__title>スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！</h1><img alt="スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！" class=card__img decoding=async height=151 loading=lazy src=https://meiryo7743.net/ja/blog/how-to-disable-screensaver-with-a-powershell-script/thumbnail.ja.webp width=288></header><nav class=share><a class=share__button href="https://www.addtoany.com/share#url=https%3A%2F%2Fmeiryo7743.net%2Fja%2Fblog%2Fhow-to-disable-screensaver-with-a-powershell-script%2F" rel=noopener target=_blank>共有</a></nav><details class=toc><summary class=toc__button>目次</summary><nav id=TableOfContents><ul><li><a href=#ありがた迷惑なスクリーンセーバー>ありがた迷惑なスクリーンセーバー</a><li><a href=#コードと導入手順>コードと導入手順</a><ul><li><a href=#特定の時間帯だけスクリーンセーバーを無効化したい場合>特定の時間帯だけスクリーンセーバーを無効化したい場合</a></ul><li><a href=#参考>参考</a></ul></nav></details><section class=single__content><h2 id=ありがた迷惑なスクリーンセーバー>ありがた迷惑なスクリーンセーバー</h2><p>最近，とある Windows PC を利用する機会があります。その PC では，3 分ほど無操作状態が続くとスクリーンセーバーが起動し，数秒後にロックされる設定になっています。この動作はセキュリティーの観点から有効になっているのでしょう。だた，別の PC と一緒にマルチタスクするときにしか使わないため，頻繁にスクリーンセーバーとご対面する羽目となり，煩わしさ感じるところが少々あります。<p>このような場合，スクリーンセーバーの設定を変えるのが一番手っ取り早く効果的な方法です。ところが，グループポリシーによって PC の設定を変えられないように制限されていました。さらに，残念ながらアプリの追加も制限されているため，<a href=https://github.com/microsoft/PowerToys rel="nofollow noopener" target=_blank>
PowerToys</a> の Awake 機能や<a href=https://www.inasoft.org/mousefr.html rel="nofollow noopener" target=_blank>
マウスふるふる</a>などで対処することも叶いません。<p>もはや物理的にマウスやキーボードを操作し続けるしか解決策はないとばかり考えていたのですが，その PC でも PowerShell は普通に使えると気が付きました。つまり，定期的に無意味なキーを押下するなどして，スクリーンセーバーを妨げる（無操作状態を回避する）PowerShell スクリプトを書けば良さそうです。<h2 id=コードと導入手順>コードと導入手順</h2><p>以下がスクリーンセーバーを妨げる（無操作状態を回避する）PowerShell スクリプトのコードになります。Windows 10 のデフォルトでインストールされている PowerShell で正しく動作することを確認済みです。<pre><code># 約 1 分おきに Shift + F15 を押下するスクリプト

$wsh = New-Object -ComObject WScript.Shell
while (1) {
  $wsh.SendKeys(&quot;+{F15}&quot;) # Shift + F15 キーを押す
  Start-Sleep -seconds 60
}
</code></pre><p>メモ帳から上記のコードをコピーして貼り付けた後，拡張子を <code>.ps1</code> として好きな場所に保存します。例えば，<code>awake.ps1</code> と名付けてデスクトップに置くと分かりやすいかもしれません。<p>注意点として，通常 <strong><code>.ps1</code> ファイルを直接ダブルクリックしてもスクリプトは実行されません</strong>。そもそも PowerShell は Windows の詳細な設定を編集できるほどに多機能・高性能なため，容易に <code>.ps1</code> ファイルを実行できない仕組みになっているのです。したがって，少しばかり工夫を凝らす必要があります。ここでは一番手軽と思われるショートカットを用いた方法を紹介します。<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup><p>まず，作成した <code>.ps1</code> ファイル（先の例では <code>awake.ps1</code>）を右クリックして，ショートカットを作成します。続いて，<strong>出来上がったショートカットを右クリック</strong>して<strong>プロパティー</strong>を開き，<strong>リンク先</strong>の先頭に<strong>以下の文字列</strong>を，そして直後に<strong>半角スペース</strong>を書き加えます。<pre><code>powershell -WindowStyle Hidden -ExecutionPolicy RemoteSigned -File
</code></pre><p>最後に <strong>OK</strong> ボタンをクリックして，<strong>プロパティー</strong>を閉じます。これでショートカットをダブルクリックすると，先ほどの <code>.ps1</code> ファイルを実行できます。実際は <code>-WindowStyle Hidden</code> オプションにより，バックグラウンドで動作するように設定しているため，PowerShell のウィンドウがすぐに消えるように見えるかもしれませんが，正しく動作しているはずです。<h3 id=特定の時間帯だけスクリーンセーバーを無効化したい場合>特定の時間帯だけスクリーンセーバーを無効化したい場合</h3><p>上記のコードでは，起動中している限りずっとスクリーンセーバーを無効化することになります。これでも良いのですが，実際には<strong>特定の時間帯に起動したときに限りスクリーンセーバーを無効化したいケース</strong>もあるでしょう。次のようにコードを書けば実現可能です。<pre><code class=language-powershell># 終了時刻まで残り何分かを取得する
function timer {
  param ($endTime)
  $start = [datetime](Get-Date -format &quot;yyyy-MM-dd HH:mm:ss&quot;)
  $end = [datetime](Get-Date -format &quot;yyyy-MM-dd&quot;) + $endTime

  return [Math]::Ceiling(($end - $start).TotalMinutes)
}

$wsh = New-Object -ComObject WScript.Shell

# 終了時刻を 12:00 とする場合の例。現在時刻が 12:00 以降であれば，何も実行されずに終了する
while ((timer(&quot;12:00&quot;)) -gt 0) {
  $wsh.SendKeys(&quot;+{F15}&quot;) # Shift + F15 キーを押す
  Start-Sleep -Seconds 60
}
</code></pre><p>もし終了時刻をより柔軟に設定したい場合は，キーボード入力を求めたり，別のファイルからデータを読み込ませたりする処理を追記してみてください。<h2 id=参考>参考</h2><ul><li><a href="https://learn.microsoft.com/en-us/powershell/scripting/windows-powershell/install/installing-windows-powershell?view=powershell-7.3" rel="nofollow noopener" target=_blank>https://learn.microsoft.com/en-us/powershell/scripting/windows-powershell/install/installing-windows-powershell?view=powershell-7.3</a><li><a href=https://gist.github.com/jamesfreeman959/231b068c3d1ed6557675f21c0e346a9c rel="nofollow noopener" target=_blank>https://gist.github.com/jamesfreeman959/231b068c3d1ed6557675f21c0e346a9c</a><li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-date?view=powershell-7.3" rel="nofollow noopener" target=_blank>https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-date?view=powershell-7.3</a><li><a href=https://step-learn.com/article/powershell/089-date-calc.html rel="nofollow noopener" target=_blank>https://step-learn.com/article/powershell/089-date-calc.html</a><li><a href=https://qiita.com/tomoko523/items/df8e384d32a377381ef9 rel="nofollow noopener" target=_blank>https://qiita.com/tomoko523/items/df8e384d32a377381ef9</a></ul><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href="https://www.google.com/search?q=ps1%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB+%E5%AE%9F%E8%A1%8C%E6%96%B9%E6%B3%95" rel="nofollow noopener" target=_blank>Google 検索</a>すると，ほかにも色々なアイデアが見つけられます。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></ol></div></section></article></main><footer class=body__footer><small class=copyright>&copy; 2019-2023 Meiryo7743</small></footer><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","dateModified":"2022-12-05T07:48:36\u002b0900","datePublished":"2022-12-05T08:00:00\u002b0900","description":"ありがた迷惑なスクリーンセーバー 最近，とある Windows PC を利用する機会があります。その PC では，3 分ほど無操作状態が続くとスクリーンセーバーが起動し，","headline":"スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！","image":["https:\/\/meiryo7743.net\/ja\/blog\/how-to-disable-screensaver-with-a-powershell-script\/thumbnail.ja.webp"],"url":"https:\/\/meiryo7743.net\/ja\/blog\/how-to-disable-screensaver-with-a-powershell-script\/","author":{"@context":"https://schema.org","@type":"Person","name":"Meiryo7743","url":"https:\/\/meiryo7743.net"},"mainEntityOfPage":{"@id":"https:\/\/meiryo7743.net\/ja\/blog\/how-to-disable-screensaver-with-a-powershell-script\/","@type":"WebPage"},"publisher":{"@context":"https://schema.org","@type":"Organization","name":"Meiryo7743","logo":{"@context":"https://schema.org","@type":"ImageObject","height":"630","url":"https:\/\/meiryo7743.net\/img\/ogp\/6569d66efbb19778efa0356946cc28d6ca2ec5bce3d5ef237dbcc2c002888ac6.png","width":"1200"}}}</script><script src=https://meiryo7743.net/js/font.min.f19571f30c2e6847c034787a2386ec2b812fa7e61149ed847c3877f1450a63d1.js></script></body></html>