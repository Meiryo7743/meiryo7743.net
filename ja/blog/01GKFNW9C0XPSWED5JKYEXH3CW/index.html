<!doctype html><html lang=ja><head prefix="https://ogp.me/ns/website#"><title>Blog > スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！ - Meiryo7743</title><meta charset=UTF-8><link rel=canonical href=https://meiryo7743.net/ja/blog/01GKFNW9C0XPSWED5JKYEXH3CW/><meta name=description content="Meiryo7743 の Web サイトです。"><meta name=robots content="index, follow"><meta property="og:title" content="Blog > スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！"><meta property="og:type" content="website"><meta property="og:image" content="https://meiryo7743.net/assets/img/ogp.png"><meta property="og:url" content="https://meiryo7743.net/ja/blog/01GKFNW9C0XPSWED5JKYEXH3CW/"><meta property="og:description" content="Meiryo7743 の Web サイトです。"><meta property="og:locale" content="ja"><meta property="og:locale:alternate" content="en"><link href=/assets/img/favicon.ico rel=icon sizes=32x32><link href=/assets/img/favicon.svg rel=icon type=image/svg+xml><link href=/assets/img/apple-touch-icon.png rel=apple-touch-icon><link href=/sitemap-index.xml rel=sitemap><meta name=author content="Meiryo7743"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no,email=no,address=no"><meta name=Hatena::Bookmark content="nocomment"><link rel=alternate hreflang=ja href=https://meiryo7743.net/ja/blog/01GKFNW9C0XPSWED5JKYEXH3CW/><link rel=alternate hreflang=en href=https://meiryo7743.net/en/blog/01GKFNW9C0XPSWED5JKYEXH3CW/><link rel=alternate hreflang=x-default href=https://meiryo7743.net/ja/blog/01GKFNW9C0XPSWED5JKYEXH3CW/><link rel=stylesheet href=/assets/_slug_.j3zwnTDn.css> <header class=fVQGRp><noscript><div class="btcLjD dCkYtO"><p class="coifUy dnRybM jnhRIx hMnPVI ioQmXa dGyMyr fyfnQk fPSBzf"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:warning-16-filled"><symbol id="ai:fluent:warning-16-filled"><path fill="currentcolor" d="M9.092 2.638a1.25 1.25.0 00-2.182.0L2.157 11.14A1.25 1.25.0 003.247 13h9.504a1.25 1.25.0 001.091-1.86zM8.75 10.25a.75.75.0 11-1.5.0.75.75.0 011.5.0M7.5 8V5.5a.5.5.0 011 0V8a.5.5.0 01-1 0"/></symbol><use xlink:href="#ai:fluent:warning-16-filled"/></svg> <span class=hlUslA>ブラウザーの設定で JavaScript が無効になっています。ページが正しく表示されない場合があります。</span></div></noscript><nav class=bqBPNl><ul class="coifUy dnRybM jnhRIx hMnPVI ioQmXa dGyMyr BEBLL cbkwRf dnRyjI fPSBzf"><li><a href=/ja/ class="bYPztT bDveUq jxUvCM jlowLP bDIyLE fPtRO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf gVSYHD diIxfU bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="meiryo7743"><symbol id="ai:local:meiryo7743"><circle cx="8" cy="8" r="8" fill="#222"/><path fill="#ddd" d="M4 4v2l2.5 2.5L4 11l1 1h5l-1-1H6l2.5-2.5L12 12v-2L9.5 7.5 12 5l-1-1H6l1 1h3L7.5 7.5 4 4z"/></symbol><use xlink:href="#ai:local:meiryo7743"/></svg> <span translate=no class=jRXsVq>Meiryo7743</span></a><li><a href=/ja/blog/ class="bYPztT bDveUq jxUvCM jlowLP bDIyLE fPtRO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf gVSYHD diIxfU bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:document-text-16-filled"><symbol id="ai:fluent:document-text-16-filled"><path fill="currentcolor" d="M8 4.5V1H4.5A1.5 1.5.0 003 2.5v11A1.5 1.5.0 004.5 15h7a1.5 1.5.0 001.5-1.5V6H9.5A1.5 1.5.0 018 4.5m1 0V1.25L12.75 5H9.5A.5.5.0 019 4.5M5.5 8h5a.5.5.0 010 1h-5a.5.5.0 010-1M5 10.5a.5.5.0 01.5-.5h5a.5.5.0 010 1h-5a.5.5.0 01-.5-.5m.5 1.5h5a.5.5.0 010 1h-5a.5.5.0 010-1"/></symbol><use xlink:href="#ai:fluent:document-text-16-filled"/></svg> <span translate=no>Blog</span></a><li><a href=/ja/blog/tags/ class="bYPztT bDveUq jxUvCM jlowLP bDIyLE fPtRO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf gVSYHD diIxfU bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:tag-16-filled"><symbol id="ai:fluent:tag-16-filled"><path fill="currentcolor" d="M2.587 7.314a1.99 1.99.0 000 2.822l3.296 3.28a2.013 2.013.0 002.836.0l4.67-4.647a2 2 0 00.587-1.397L14 4.01A2 2 0 0011.987 2l-3.25.014a2 2 0 00-1.41.584zM11 6a1 1 0 110-2 1 1 0 010 2"/></symbol><use xlink:href="#ai:fluent:tag-16-filled"/></svg> <span translate=no>Tags</span></a><li><a href=https://forms.gle/MBh57otLQ7wLQrt8A target=_blank rel=nofollow class="bYPztT bDveUq jxUvCM jlowLP bDIyLE fPtRO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf gVSYHD diIxfU bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:mail-16-filled"><symbol id="ai:fluent:mail-16-filled"><path fill="currentcolor" d="M4 3A2 2 0 002 5v.201l6 3.231 6-3.23V5a2 2 0 00-2-2zm10 3.337L8.237 9.44a.5.5.0 01-.474.0L2 6.337V11a2 2 0 002 2h8a2 2 0 002-2z"/></symbol><use xlink:href="#ai:fluent:mail-16-filled"/></svg> <span class="bYPztT fPSBzf"><span translate=no>Contact</span><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN jNnFZz jNnJyH ifPBCK" data-icon="fluent:open-16-filled"><symbol id="ai:fluent:open-16-filled"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></symbol><use xlink:href="#ai:fluent:open-16-filled"/></svg></span></a><li><a href=/ja/ lang=ja class="bYPztT bDveUq jxUvCM jlowLP bDIyLE fPtRO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf gVSYHD diIxfU bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:local-language-16-filled"><symbol id="ai:fluent:local-language-16-filled"><path fill="currentcolor" d="M7.75 2a.75.75.0 000 1.5H9.5v.751c0 .385-.097.679-.227.855-.111.151-.263.247-.515.247a.75.75.0 000 1.5 2.08 2.08.0 001.724-.859c.367-.5.518-1.132.518-1.743V2.75A.75.75.0 0010.25 2zM6.698 4.725a.75.75.0 00-1.396.0l-3.254 8.25a.75.75.0 101.395.55l.799-2.024h3.513l.797 2.024a.75.75.0 001.396-.55zm.466 5.276h-2.33L6 7.045zM12.75 2a.75.75.0 01.75.75v2.248h.25a.75.75.0 010 1.5h-.25v3.751a.75.75.0 01-1.5.0V2.75a.75.75.0 01.75-.75"/></symbol><use xlink:href="#ai:fluent:local-language-16-filled"/></svg> <span translate=no>日本語</span></a><li><a href=/en/ lang=en class="bYPztT bDveUq jxUvCM jlowLP bDIyLE fPtRO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf gVSYHD diIxfU bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:local-language-16-filled"><use xlink:href="#ai:fluent:local-language-16-filled"/></svg> <span translate=no>English</span></a></ul></nav></header><main><article><header class=hbhCaX><div class="coifUy dnRybM jnhRIx hMnPVI jwdzGr kXZHwL dGyMyr bYPztT fPSBzf iRgpoQ"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jySYdq jySUHe" data-icon="fluent:document-text-16-filled"><use xlink:href="#ai:fluent:document-text-16-filled"/></svg><h1 class="ehtvDz dnRxXd jRXsVq fZXUkm">スクリーンセーバー……駆逐してやる！　PC から……一つ残らず！</h1><ul class="coPWWb bYPznK dnRyjI VJSKb fPSBzf gasSYy"><li><time datetime=2022-12-05T08:00:00+09:00 class="bYPztT dnRKIT fPSBzf hZMpKn"><svg width="1em" height="1em" viewBox="0 0 16 16" aria-label="初版公開日" class="ghouwM ghopuk" data-icon="fluent:calendar-16-filled"><symbol id="ai:fluent:calendar-16-filled"><path fill="currentcolor" d="M14 11.5V6H2v5.5A2.5 2.5.0 004.5 14h7a2.5 2.5.0 002.5-2.5M5.997 8.248a.748.748.0 11-1.497.0.748.748.0 011.497.0m0 2.5a.748.748.0 11-1.497.0.748.748.0 011.497.0m2.752-2.5a.748.748.0 11-1.497.0.748.748.0 011.497.0m0 2.5a.748.748.0 11-1.497.0.748.748.0 011.497.0m2.748-2.5a.748.748.0 11-1.497.0.748.748.0 011.497.0M14 4.5A2.5 2.5.0 0011.5 2h-7A2.5 2.5.0 002 4.5V5h12z"/></symbol><use xlink:href="#ai:fluent:calendar-16-filled"/></svg> 2022-12-05</time><li><time datetime=2024-07-19T17:53:52Z class="bYPztT dnRKIT fPSBzf hZMpKn"><svg width="1em" height="1em" viewBox="0 0 16 16" aria-label="最終更新日" class="ghouwM ghopuk" data-icon="fluent:history-16-filled"><symbol id="ai:fluent:history-16-filled"><path fill="currentcolor" d="M8 3.5A4.5 4.5.0 113.545 8.64.75.75.0 002.06 8.852 6.001 6.001.0 104 3.528V2.75a.75.75.0 00-1.5.0v3c0 .414.336.75.75.75h2.5a.75.75.0 000-1.5H4.646A4.5 4.5.0 018 3.5m.5 2.25a.75.75.0 00-1.5.0v2.5c0 .414.336.75.75.75h2a.75.75.0 000-1.5H8.5z"/></symbol><use xlink:href="#ai:fluent:history-16-filled"/></svg> 2024-07-19</time></ul><ul class="fyfnQk fPSBzf gasSYy fZXUkm bLxKQR"><li><a href=/ja/blog/tags/powershell/ class="bYPztT bqBPNl bDveUq jxUvCM jlowLP bDIyLE cpIoGO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf diIxfU gnlqYH bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:tag-16-filled"><use xlink:href="#ai:fluent:tag-16-filled"/></svg> <span class=jRXsVq>PowerShell</span></a><li><a href=/ja/blog/tags/備忘録/ class="bYPztT bqBPNl bDveUq jxUvCM jlowLP bDIyLE cpIoGO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf diIxfU gnlqYH bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:tag-16-filled"><use xlink:href="#ai:fluent:tag-16-filled"/></svg> <span class=jRXsVq>備忘録</span></a><li><a href=/ja/blog/tags/advent-calender/ class="bYPztT bqBPNl bDveUq jxUvCM jlowLP bDIyLE cpIoGO jrHZPA hDGJaH dNTNvO fyfnQk fPSBzf diIxfU gnlqYH bLxLlJ fyfohc"><svg width="1em" height="1em" viewBox="0 0 16 16" class="jmzEDN ghouwM ghopuk" data-icon="fluent:tag-16-filled"><use xlink:href="#ai:fluent:tag-16-filled"/></svg> <span class=jRXsVq>Advent Calender</span></a></ul></div></header><section class=bqBPNl><div id=content class="coifUy dnRybM jnhRIx hMnPVI jwdzGr kXZHwL jiLEiz jsffLY cJmOgC"><h2 id=ありがた迷惑なスクリーンセーバー>ありがた迷惑なスクリーンセーバー</h2><p>最近，とある Windows PC を利用する機会があります。その PC では，3 分ほど無操作状態が続くとスクリーンセーバーが起動し，数秒後にロックされる設定になっています。この動作はセキュリティーの観点から有効になっているのでしょう。だた，別の PC と一緒にマルチタスクするときにしか使わないため，頻繁にスクリーンセーバーとご対面する羽目となり，煩わしさ感じるところが少々あります。<p>このような場合，スクリーンセーバーの設定を変えるのが一番手っ取り早く効果的な方法です。ところが，グループポリシーによって PC の設定を変えられないように制限されていました。さらに，残念ながらアプリの追加も制限されているため，<a href=https://github.com/microsoft/PowerToys rel=nofollow target=_blank>PowerToys<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a> の Awake 機能や<a href=https://www.inasoft.org/mousefr.html rel=nofollow target=_blank>マウスふるふる<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a>などで対処することも叶いません。<p>もはや物理的にマウスやキーボードを操作し続けるしか解決策はないとばかり考えていたのですが，その PC でも PowerShell は普通に使えると気が付きました。つまり，定期的に無意味なキーを押下するなどして，スクリーンセーバーを妨げる（無操作状態を回避する）PowerShell スクリプトを書けば良さそうです。<h2 id=コードと導入手順>コードと導入手順</h2><p>以下がスクリーンセーバーを妨げる（無操作状態を回避する）PowerShell スクリプトのコードになります。Windows 10 のデフォルトでインストールされている PowerShell で正しく動作することを確認済みです。<pre class="astro-code astro-code-themes github-light github-dark" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0 data-language=powershell><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 約 1 分おきに Shift + F15 を押下するスクリプト</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$wsh </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> New-Object</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8>ComObject WScript.Shell</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>while</span><span style=color:#24292e;--shiki-dark:#E1E4E8> (</span><span style=color:#005cc5;--shiki-dark:#79B8FF>1</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  $wsh.SendKeys(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"+{F15}"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#6a737d;--shiki-dark:#6A737D># Shift + F15 キーを押す</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>  Start-Sleep</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8>seconds </span><span style=color:#005cc5;--shiki-dark:#79B8FF>60</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre><p>メモ帳から上記のコードをコピーして貼り付けた後，拡張子を <code>.ps1</code> として好きな場所に保存します。例えば，<code>awake.ps1</code> と名付けてデスクトップに置くと分かりやすいかもしれません。<p>注意点として，通常 <strong><code>.ps1</code> ファイルを直接ダブルクリックしてもスクリプトは実行されません</strong>。そもそも PowerShell は Windows の詳細な設定を編集できるほどに多機能・高性能なため，容易に <code>.ps1</code> ファイルを実行できない仕組みになっているのです。したがって，少しばかり工夫を凝らす必要があります。ここでは一番手軽と思われるショートカットを用いた方法を紹介します。<sup><a href=#user-content-fn-ways-to-run-ps1 id=user-content-fnref-ways-to-run-ps1 data-footnote-ref aria-describedby=footnote-label>1</a></sup><p>まず，作成した <code>.ps1</code> ファイル（先の例では <code>awake.ps1</code>）を右クリックして，ショートカットを作成します。続いて，<strong>出来上がったショートカットを右クリック</strong>して<strong>プロパティー</strong>を開き，<strong>リンク先</strong>の先頭に<strong>以下の文字列</strong>を，そして直後に<strong>半角スペース</strong>を書き加えます。<pre class="astro-code astro-code-themes github-light github-dark" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0 data-language=powershell><code><span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>powershell </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>WindowStyle </span><span style=color:#d73a49;--shiki-dark:#F97583>Hidden</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8>ExecutionPolicy RemoteSigned </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8>File</span></span>
<span class=line></span></code></pre><p>最後に <strong>OK</strong> ボタンをクリックして，<strong>プロパティー</strong>を閉じます。これでショートカットをダブルクリックすると，先ほどの <code>.ps1</code> ファイルを実行できます。実際は <code>-WindowStyle Hidden</code> オプションにより，バックグラウンドで動作するように設定しているため，PowerShell のウィンドウがすぐに消えるように見えるかもしれませんが，正しく動作しているはずです。<h3 id=特定の時間帯だけスクリーンセーバーを無効化したい場合>特定の時間帯だけスクリーンセーバーを無効化したい場合</h3><p>上記のコードでは，起動中している限りずっとスクリーンセーバーを無効化することになります。これでも良いのですが，実際には<strong>特定の時間帯に起動したときに限りスクリーンセーバーを無効化したいケース</strong>もあるでしょう。次のようにコードを書けば実現可能です。<pre class="astro-code astro-code-themes github-light github-dark" style=background-color:#fff;--shiki-dark-bg:#24292e;color:#24292e;--shiki-dark:#e1e4e8;overflow-x:auto tabindex=0 data-language=powershell><code><span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 終了時刻まで残り何分かを取得する</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>function</span><span style=color:#6f42c1;--shiki-dark:#B392F0> timer</span><span style=color:#24292e;--shiki-dark:#E1E4E8> {</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>  param</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ($endTime)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  $start </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>datetime</span><span style=color:#24292e;--shiki-dark:#E1E4E8>](</span><span style=color:#005cc5;--shiki-dark:#79B8FF>Get-Date</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8>format </span><span style=color:#032f62;--shiki-dark:#9ECBFF>"yyyy-MM-dd HH:mm:ss"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  $end </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>datetime</span><span style=color:#24292e;--shiki-dark:#E1E4E8>](</span><span style=color:#005cc5;--shiki-dark:#79B8FF>Get-Date</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8>format </span><span style=color:#032f62;--shiki-dark:#9ECBFF>"yyyy-MM-dd"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#d73a49;--shiki-dark:#F97583>+</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $endTime</span></span>
<span class=line></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>  return</span><span style=color:#24292e;--shiki-dark:#E1E4E8> [</span><span style=color:#d73a49;--shiki-dark:#F97583>Math</span><span style=color:#24292e;--shiki-dark:#E1E4E8>]::Ceiling(($end </span><span style=color:#d73a49;--shiki-dark:#F97583>-</span><span style=color:#24292e;--shiki-dark:#E1E4E8> $start).TotalMinutes)</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>$wsh </span><span style=color:#d73a49;--shiki-dark:#F97583>=</span><span style=color:#005cc5;--shiki-dark:#79B8FF> New-Object</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8>ComObject WScript.Shell</span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d;--shiki-dark:#6A737D># 終了時刻を 12:00 とする場合の例。現在時刻が 12:00 以降であれば，何も実行されずに終了する</span></span>
<span class=line><span style=color:#d73a49;--shiki-dark:#F97583>while</span><span style=color:#24292e;--shiki-dark:#E1E4E8> ((timer(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"12:00"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>)) </span><span style=color:#d73a49;--shiki-dark:#F97583>-gt</span><span style=color:#005cc5;--shiki-dark:#79B8FF> 0</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) {</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>  $wsh.SendKeys(</span><span style=color:#032f62;--shiki-dark:#9ECBFF>"+{F15}"</span><span style=color:#24292e;--shiki-dark:#E1E4E8>) </span><span style=color:#6a737d;--shiki-dark:#6A737D># Shift + F15 キーを押す</span></span>
<span class=line><span style=color:#005cc5;--shiki-dark:#79B8FF>  Start-Sleep</span><span style=color:#d73a49;--shiki-dark:#F97583> -</span><span style=color:#24292e;--shiki-dark:#E1E4E8>Seconds </span><span style=color:#005cc5;--shiki-dark:#79B8FF>60</span></span>
<span class=line><span style=color:#24292e;--shiki-dark:#E1E4E8>}</span></span>
<span class=line></span></code></pre><p>もし終了時刻をより柔軟に設定したい場合は，キーボード入力を求めたり，別のファイルからデータを読み込ませたりする処理を追記してみてください。<h2 id=参考>参考</h2><ol><li><a href="https://learn.microsoft.com/en-us/powershell/scripting/windows-powershell/install/installing-windows-powershell?view=powershell-7.3" rel=nofollow target=_blank>What is Windows PowerShell? - PowerShell | Microsoft Learn<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a><li><a href=https://gist.github.com/jamesfreeman959/231b068c3d1ed6557675f21c0e346a9c rel=nofollow target=_blank>A very simple PowerShell script to keep a Windows PC awake and make lync think the user is active on the keyboard · GitHub<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a><li><a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/get-date?view=powershell-7.3" rel=nofollow target=_blank>Get-Date (Microsoft.PowerShell.Utility) - PowerShell | Microsoft Learn<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a><li><a href=https://step-learn.com/article/powershell/089-date-calc.html rel=nofollow target=_blank>PowerShell: 日付・時刻の計算（加算と減算）<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a><li><a href=https://qiita.com/tomoko523/items/df8e384d32a377381ef9 rel=nofollow target=_blank>Powershellを楽に実行してもらうには #PowerShell - Qiita<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a></ol><section data-footnotes class=footnotes><h2 class=sr-only id=footnote-label>Footnotes</h2><ol><li id=user-content-fn-ways-to-run-ps1><p><a href="https://www.google.com/search?q=ps1%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB+%E5%AE%9F%E8%A1%8C%E6%96%B9%E6%B3%95" rel=nofollow target=_blank>Google 検索<span><svg viewBox="0 0 16 16" width="16" height="16"><path fill="currentcolor" d="M4.75 3.5c-.69.0-1.25.56-1.25 1.25v6.5c0 .69.56 1.25 1.25 1.25h6.5c.69.0 1.25-.56 1.25-1.25v-1.5a.75.75.0 011.5.0v1.5A2.75 2.75.0 0111.25 14h-6.5A2.75 2.75.0 012 11.25v-6.5A2.75 2.75.0 014.75 2h1.5a.75.75.0 010 1.5zM8 2.75A.75.75.0 018.75 2h4.5a.75.75.0 01.75.75v4.5a.75.75.0 01-1.5.0V4.561l-3.22 3.22A.75.75.0 118.22 6.72l3.22-3.22H8.75A.75.75.0 018 2.75"/></svg></span></a>すると，ほかにも色々なアイデアが見つけられます。 <a href=#user-content-fnref-ways-to-run-ps1 data-footnote-backref aria-label="Back to reference 1" class=data-footnote-backref>↩</a></ol></section></div></section></article></main><footer class="bqBPNl fYgLLj"><p class="coifUy dnRybM jnhRIx hMnPVI ioQmXa dGyMyr bYPzoC"><small class=dnRKwm>© 2019-2024 Meiryo7743</small></footer>